# 通信

___

## 知识点

Qt已经为我们提供了QTcpServer（服务端）和QTcpSocket用来通信。客户端接入和断开都有相应的信号。

## 大致的流程

接入成功后，首先进行登录字符串检验和文件效验（MD5），然后：

- 客户端：
  1. UI转入大厅界面
- 服务端：
  1. 新开一个ServerPlayer对象，用来保存客户端的socket
  2. 向新人报道一下大厅的状况

## 如何通信

通信一律用JSON字符串进行，JSON分为这几个部分：

1. Packet的大类型，Enum，分为Notify和Request和Reply这几种。然后根据目标的不同分为Client、Lobby、Room。位运算。
2. Packet的详细类型，是一个字符串。
3. Packet附带的更多信息，是JSON对象。反正是根据不同字符串去调用不同的处理函数。

服务器可能同时收到很多，可以把待处理的用队列存住。

## 倒计时

服务器等倒计时，同时也告诉客户端。可以发Packet？
